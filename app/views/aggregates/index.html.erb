
<div class="container">

      <div class="page-header" id="banner">
        <div class="row">
          <div class="col-sm-12">
                  <div class="row">
                    <div class="col-sm-4">
                      <button type="button" class="btn btn-default btn-lg btn-block" data-toggle="modal" data-target="#folder">Add Folder</button>
                    </div>
                    <div class="col-sm-4">
                      
                    <%=link_to "Add File", {:action=>:explore, :controller=>:aggregates, :path=>"home"}, :class=>"btn btn-default btn-lg btn-block" %>
                    </div>
                    <div class="col-sm-4">
                      <button type="button" class="btn btn-default btn-lg btn-block" data-toggle="modal" data-target="#myModal">Search</button>
                    </div>

                  </div>
            <div class="row">
                <div>
                  <table class="table table-striped table-hover">
                      <thead>
                        <tr>

                          <th></th>
                          <%if @orderby == "file_name"%>
                            <th class="text-info">File name</th>
                          <%else%>
                            <th><%= link_to "File name",
                           :action=>:index, :controller=>:aggregates, :orderby=>"file_name"%></th>
                          <%end%>

                          <%if @orderby =="file"%>
                            <th class="text-info">File Path</th>
                          <%else%>
                            <th><%= link_to "File Path",
                             :action=>:index, :controller=>:aggregates,
                             :orderby=>"file"%></th>
                          <%end%>

                          <th>Categories</th>

                          <%if @orderby == "file_type"%>
                            <th class="text-info">File Type</th>
                          <%else%>
                            <th><%= link_to "File type",
                             :action=>:index, :controller=>:aggregates,
                             :orderby=>"file_type"%></th>
                          <%end%>


                          <%if @orderby == "created_at"%>
                            <th class="text-info">Created at</th>
                          <%else%>
                            <th><%= link_to "Created at",
                             :action=>:index, :controller=>:aggregates,
                             :orderby=>"created_at"%></th>
                          <%end%>

                          <%if @orderby == "updated_at"%>
                            <th class="text-info">Last Modified</th>
                          <%else%>
                            <th><%= link_to "Last Modified",
                             :action=>:index, :controller=>:aggregates,
                             :orderby=>"updated_at"%></th>
                          <%end%>


                          <th colspan="3">Actions</th>
                        </tr>
                      </thead>
                        <tbody>
                          <% @aggregates.each do |aggregate| %>
                            <tr class="active" >
                              <%if aggregate.file_type == 'folder' %>
                                <td><%= image_tag "/images/folder_icon.png", style:"height:25px; width:25px"%></td>
                              <%else%>
                                <td><%= image_tag "/images/file_icon.png", style:"height:25px; width:25px"%></td>
                              <%end%>
                                <td><%= aggregate.file_name %></td>
                                <% 
                                if( aggregate.file_type != 'folder' )
                                  tempArray = aggregate.file.split("/")
                                  folderPath = tempArray[0..tempArray.size()-2].join("/")
                                  file=tempArray[tempArray.size()-1]
                                %>
                                  <td><%= link_to folderPath, {:action=>:explore, :contoller=>:aggregates, :path=>folderPath}, :style=>"color:yellow"%>/<%=file%></td>
                                <%else%>
                                  <td></td>
                                <%end%>
                                <td><span class="badge"><%= aggregate.categories.size %> categories</span></td>
                                <td><%= aggregate.file_type %></td>
                                <td><%= aggregate.created_at.strftime("%m-%d-%Y %I:%M%p")%></td>

                                <td><%= aggregate.updated_at.strftime("%m-%d-%Y %I:%M%p")%></td>
                                <td><%= link_to 'Show', aggregate, :class=>"btn btn-xs btn-success" %></td>
                                <td><%= link_to 'Edit', edit_aggregate_path(aggregate), :class=>"btn btn-xs btn-info" %></td>
                                <td><%= link_to 'Delete', aggregate, method: :delete, :class=>"btn btn-xs btn-danger" ,data: { confirm: 'Are you sure?' } %></td>
                                </tr>
                              
                          <% end %>
                        </tbody>
                  </table>
                  <script type="text/javascript">

  $('tbody').sortable();

</script>
                </div>
                </div>

               
                <!-- Modal -->
                
                    
                    
                    <!-- Modal -->
                    <div class="modal fade" id="myModal" role="dialog">
                      <div class="modal-dialog modal-lg">
                      
                        <!-- Modal content-->
                        <div class="modal-content">
                          <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Search Parameters</h4>
                          </div>
                          <div class="modal-body">
                            <%= render 'formSearch', categories: @categories %>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                          </div>
                        </div>
                        
                      </div>
                    </div>
                   
                <!-- -->
                <div class="modal fade" id="folder" role="dialog">
                      <div class="modal-dialog modal-lg">
                      
                        <!-- Modal content-->
                        <div class="modal-content">
                          <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">New Folder</h4>
                          </div>
                          <div class="modal-body">
                            <%= render 'formfolder' %>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                          </div>
                        </div>
                        
                      </div>
                    </div>
              
          </div>
        </div>
    </div>
</div>

